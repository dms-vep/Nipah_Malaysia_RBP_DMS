<!DOCTYPE html>
<html>
<head>
  <style>
    #vis.vega-embed {
      width: 100%;
      display: flex;
    }

    #vis.vega-embed details,
    #vis.vega-embed details summary {
      position: relative;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@5.15.1"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"background": "transparent", "title": {"fontSize": 14, "font": "Helvetica", "anchor": "middle", "color": "#000000"}, "axisX": {"domain": true, "domainColor": "black", "domainWidth": 1, "grid": true, "gridColor": "lightgray", "gridWidth": 0.5, "labelFont": "Helvetica", "labelFontSize": 12, "labelAngle": 0, "tickColor": "black", "tickSize": 4, "titleFont": "Helvetica", "tickCount": 3, "titleFontSize": 14, "titlePadding": 5}, "axisY": {"domain": true, "domainColor": "black", "domainWidth": 1, "grid": true, "gridColor": "lightgray", "gridWidth": 0.5, "labelFont": "Helvetica", "labelFontSize": 12, "labelAngle": 0, "tickColor": "black", "tickSize": 4, "tickCount": 3, "titleFont": "Helvetica", "titleFontSize": 14, "titlePadding": 5, "titleAngle": 270}, "legend": {"labelFont": "Helvetica", "labelFontSize": 12, "symbolSize": 75, "titleFont": "Helvetica", "titleFontSize": 14, "padding": 5, "titleLimit": 200, "gradientLength": 75}, "range": {"category": ["#1f4e79", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf"], "diverging": ["#c7e9b4", "#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494"]}, "view": {"stroke": "transparent"}}, "data": {"name": "data-0094916dea68c49f5e5ca95b95300bf9"}, "mark": {"type": "rect"}, "encoding": {"color": {"field": "escape_median", "type": "quantitative"}, "tooltip": [{"field": "site", "type": "quantitative"}, {"field": "wildtype", "type": "nominal"}, {"field": "mutant", "type": "nominal"}, {"field": "escape_median", "type": "quantitative"}], "x": {"axis": {"grid": false, "labelAngle": -90}, "field": "mutation", "sort": {"field": "mutation_number"}, "title": "Site", "type": "ordinal"}, "y": {"axis": {"grid": false}, "field": "ab", "sort": ["m102.4", "HENV-26", "HENV-117", "HENV-103", "HENV-32", "nAH1.3"], "title": "Mutant", "type": "ordinal"}}, "height": {"step": 20}, "width": {"step": 30}, "$schema": "https://vega.github.io/schema/vega-lite/v5.15.1.json", "datasets": {"data-0094916dea68c49f5e5ca95b95300bf9": [{"site": 277, "wildtype": "N", "mutant": "Y", "mutation": "N277Y", "effect": -0.05559, "escape_median": 0.2183, "escape_std": 0.303, "times_seen_ab": 7.0, "show_site": true, "ab": "HENV-103", "wt_codon": "AAC", "closest_mutant_codon": "TAC", "min_mutations": 1, "mutation_number": 277}, {"site": 277, "wildtype": "N", "mutant": "Y", "mutation": "N277Y", "effect": -0.05559, "escape_median": 0.2753, "escape_std": 0.07357, "times_seen_ab": 6.75, "show_site": true, "ab": "HENV-32", "wt_codon": "AAC", "closest_mutant_codon": "TAC", "min_mutations": 1, "mutation_number": 277}, {"site": 171, "wildtype": "Y", "mutant": "D", "mutation": "Y171D", "effect": -0.8157, "escape_median": 0.611, "escape_std": 0.1968, "times_seen_ab": 10.0, "show_site": true, "ab": "HENV-117", "wt_codon": "TAT", "closest_mutant_codon": "GAT", "min_mutations": 1, "mutation_number": 171}, {"site": 171, "wildtype": "Y", "mutant": "D", "mutation": "Y171D", "effect": -0.8157, "escape_median": 0.4248, "escape_std": 0.1176, "times_seen_ab": 9.333, "show_site": true, "ab": "HENV-26", "wt_codon": "TAT", "closest_mutant_codon": "GAT", "min_mutations": 1, "mutation_number": 171}, {"site": 171, "wildtype": "Y", "mutant": "N", "mutation": "Y171N", "effect": -0.4004, "escape_median": 0.2709, "escape_std": 0.2368, "times_seen_ab": 2.667, "show_site": true, "ab": "HENV-117", "wt_codon": "TAT", "closest_mutant_codon": "AAT", "min_mutations": 1, "mutation_number": 171}, {"site": 171, "wildtype": "Y", "mutant": "N", "mutation": "Y171N", "effect": -0.4004, "escape_median": 0.382, "escape_std": 0.1679, "times_seen_ab": 3.0, "show_site": true, "ab": "HENV-26", "wt_codon": "TAT", "closest_mutant_codon": "AAT", "min_mutations": 1, "mutation_number": 171}, {"site": 171, "wildtype": "Y", "mutant": "S", "mutation": "Y171S", "effect": -0.03941, "escape_median": 0.2825, "escape_std": 0.3046, "times_seen_ab": 3.333, "show_site": true, "ab": "HENV-117", "wt_codon": "TAT", "closest_mutant_codon": "TCT", "min_mutations": 1, "mutation_number": 171}, {"site": 171, "wildtype": "Y", "mutant": "S", "mutation": "Y171S", "effect": -0.03941, "escape_median": 0.2435, "escape_std": 0.1303, "times_seen_ab": 3.333, "show_site": true, "ab": "HENV-26", "wt_codon": "TAT", "closest_mutant_codon": "TCT", "min_mutations": 1, "mutation_number": 171}, {"site": 582, "wildtype": "D", "mutant": "E", "mutation": "D582E", "effect": -0.5741, "escape_median": 0.3436, "escape_std": 0.03113, "times_seen_ab": 7.0, "show_site": true, "ab": "HENV-117", "wt_codon": "GAC", "closest_mutant_codon": "GAA", "min_mutations": 1, "mutation_number": 582}, {"site": 582, "wildtype": "D", "mutant": "E", "mutation": "D582E", "effect": -0.5741, "escape_median": 0.7627, "escape_std": 0.2023, "times_seen_ab": 7.0, "show_site": true, "ab": "m102.4", "wt_codon": "GAC", "closest_mutant_codon": "GAA", "min_mutations": 1, "mutation_number": 582}, {"site": 582, "wildtype": "D", "mutant": "G", "mutation": "D582G", "effect": -0.281, "escape_median": 0.685, "escape_std": 0.2414, "times_seen_ab": 4.667, "show_site": true, "ab": "HENV-117", "wt_codon": "GAC", "closest_mutant_codon": "GGC", "min_mutations": 1, "mutation_number": 582}, {"site": 582, "wildtype": "D", "mutant": "G", "mutation": "D582G", "effect": -0.281, "escape_median": 1.392, "escape_std": 0.06671, "times_seen_ab": 5.0, "show_site": true, "ab": "m102.4", "wt_codon": "GAC", "closest_mutant_codon": "GGC", "min_mutations": 1, "mutation_number": 582}, {"site": 582, "wildtype": "D", "mutant": "V", "mutation": "D582V", "effect": 0.5197, "escape_median": 0.3445, "escape_std": 0.2271, "times_seen_ab": 5.333, "show_site": true, "ab": "HENV-117", "wt_codon": "GAC", "closest_mutant_codon": "GTC", "min_mutations": 1, "mutation_number": 582}, {"site": 582, "wildtype": "D", "mutant": "V", "mutation": "D582V", "effect": 0.5197, "escape_median": 0.5071, "escape_std": 0.0446, "times_seen_ab": 5.5, "show_site": true, "ab": "m102.4", "wt_codon": "GAC", "closest_mutant_codon": "GTC", "min_mutations": 1, "mutation_number": 582}, {"site": 586, "wildtype": "N", "mutant": "I", "mutation": "N586I", "effect": -0.8564, "escape_median": 0.6671, "escape_std": 0.3462, "times_seen_ab": 4.667, "show_site": true, "ab": "HENV-117", "wt_codon": "AAT", "closest_mutant_codon": "ATT", "min_mutations": 1, "mutation_number": 586}, {"site": 586, "wildtype": "N", "mutant": "I", "mutation": "N586I", "effect": -0.8564, "escape_median": 1.147, "escape_std": 0.2457, "times_seen_ab": 5.333, "show_site": true, "ab": "m102.4", "wt_codon": "AAT", "closest_mutant_codon": "ATT", "min_mutations": 1, "mutation_number": 586}, {"site": 586, "wildtype": "N", "mutant": "K", "mutation": "N586K", "effect": 0.2379, "escape_median": 0.4828, "escape_std": 0.4105, "times_seen_ab": 7.0, "show_site": true, "ab": "HENV-117", "wt_codon": "AAT", "closest_mutant_codon": "AAA", "min_mutations": 1, "mutation_number": 586}, {"site": 586, "wildtype": "N", "mutant": "K", "mutation": "N586K", "effect": 0.2379, "escape_median": 0.8939, "escape_std": 0.2192, "times_seen_ab": 7.5, "show_site": true, "ab": "m102.4", "wt_codon": "AAT", "closest_mutant_codon": "AAA", "min_mutations": 1, "mutation_number": 586}, {"site": 586, "wildtype": "N", "mutant": "T", "mutation": "N586T", "effect": -0.06898, "escape_median": 0.3917, "escape_std": 0.4085, "times_seen_ab": 6.667, "show_site": true, "ab": "HENV-117", "wt_codon": "AAT", "closest_mutant_codon": "ACT", "min_mutations": 1, "mutation_number": 586}, {"site": 586, "wildtype": "N", "mutant": "T", "mutation": "N586T", "effect": -0.06898, "escape_median": 0.7551, "escape_std": 0.4462, "times_seen_ab": 5.5, "show_site": true, "ab": "m102.4", "wt_codon": "AAT", "closest_mutant_codon": "ACT", "min_mutations": 1, "mutation_number": 586}, {"site": 586, "wildtype": "N", "mutant": "Y", "mutation": "N586Y", "effect": 0.3661, "escape_median": 0.2507, "escape_std": 0.1943, "times_seen_ab": 3.667, "show_site": true, "ab": "HENV-117", "wt_codon": "AAT", "closest_mutant_codon": "TAT", "min_mutations": 1, "mutation_number": 586}, {"site": 586, "wildtype": "N", "mutant": "Y", "mutation": "N586Y", "effect": 0.3661, "escape_median": 0.3221, "escape_std": 0.5256, "times_seen_ab": 4.5, "show_site": true, "ab": "m102.4", "wt_codon": "AAT", "closest_mutant_codon": "TAT", "min_mutations": 1, "mutation_number": 586}, {"site": 589, "wildtype": "R", "mutant": "I", "mutation": "R589I", "effect": -0.8698, "escape_median": 0.41, "escape_std": 0.1711, "times_seen_ab": 3.333, "show_site": true, "ab": "HENV-117", "wt_codon": "AGA", "closest_mutant_codon": "ATA", "min_mutations": 1, "mutation_number": 589}, {"site": 589, "wildtype": "R", "mutant": "I", "mutation": "R589I", "effect": -0.8698, "escape_median": 0.3944, "escape_std": 0.1107, "times_seen_ab": 3.0, "show_site": true, "ab": "m102.4", "wt_codon": "AGA", "closest_mutant_codon": "ATA", "min_mutations": 1, "mutation_number": 589}, {"site": 589, "wildtype": "R", "mutant": "S", "mutation": "R589S", "effect": -0.6822, "escape_median": 0.446, "escape_std": 0.2752, "times_seen_ab": 6.667, "show_site": true, "ab": "HENV-117", "wt_codon": "AGA", "closest_mutant_codon": "AGC", "min_mutations": 1, "mutation_number": 589}, {"site": 589, "wildtype": "R", "mutant": "S", "mutation": "R589S", "effect": -0.6822, "escape_median": 0.7249, "escape_std": 0.2265, "times_seen_ab": 8.0, "show_site": true, "ab": "m102.4", "wt_codon": "AGA", "closest_mutant_codon": "AGC", "min_mutations": 1, "mutation_number": 589}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>